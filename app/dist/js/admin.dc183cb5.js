(function(e){function t(t){for(var n,s,i=t[0],l=t[1],u=t[2],d=0,f=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&f.push(a[s][0]),a[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);c&&c(t);while(f.length)f.shift()();return o.push.apply(o,u||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,i=1;i<r.length;i++){var l=r[i];0!==a[l]&&(n=!1)}n&&(o.splice(t--,1),e=s(s.s=r[0]))}return e}var n={},a={admin:0},o=[];function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=n,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var c=l;o.push([2,"chunk-vendors"]),r()})({0:function(e,t){},"136a":function(e,t,r){"use strict";r("4160"),r("159b");var n=r("2909");function a(){window.TDGA&&(o.forEach((function(e){var t;(t=window.TDGA)[e.fn].apply(t,Object(n["a"])(e.args))})),o=null)}var o=[];t["a"]=new Proxy({},{get:function(e,t){return window.TDGA?(o&&a(),function(){var e;return(e=window.TDGA)[t].apply(e,arguments)}):function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];o.push({fn:t,args:r})}}})},2:function(e,t,r){e.exports=r("9150")},"2d71":function(e,t,r){"use strict";r.d(t,"b",(function(){return i}));var n=r("7ed9");function a(e){return function(t){t&&"access denied"==t?(e("登录已失效，请重登"),n["b"].$emit("relogin")):e.apply(null,arguments)}}var o=Object(n["c"])(),s=new Proxy(o,{get:function(e,t){if("emit"==t)return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if("function"===typeof t[t.length-1]){var n=t.pop();t.push(a(n))}o.emit.apply(o,t)};var r=o[t];return"function"===typeof r?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.apply(o,t)}:r}});function i(e){return"function"===typeof e?e(s):s}t["a"]={loggedIn:function(){return s.isLogined},logout:function(){localStorage.adminAccount=void 0,localStorage.adminToken=void 0,s.isLogined=void 0},stdret:a}},"7ed9":function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return b}));r("7db0"),r("c975"),r("a434"),r("b0c0"),r("a9e3"),r("4d63"),r("ac1f"),r("25f0"),r("5319"),r("1276");var n,a=r("2b0e"),o=r("0b16"),s=r.n(o),i=r("df7c"),l=r.n(i),u=r("4bea"),c=r.n(u),d=r("136a"),f={getItem:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[-.+*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,t,r,n,a,o){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var s="";if(r)switch(r.constructor){case Number:s=r===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+r;break;case String:s="; expires="+r;break;case Date:s="; expires="+r.toUTCString();break}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+s+(a?"; domain="+a:"")+(n?"; path="+n:"")+(o?"; secure":""),!0},removeItem:function(e,t,r){return!(!e||!this.hasItem(e))&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(r?"; domain="+r:"")+(t?"; path="+t:""),!0)},hasItem:function(e){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[-.+*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=0;t<e.length;t++)e[t]=decodeURIComponent(e[t]);return e}},p=new a["default"];function b(e){if(n)n.disconnected&&n.connect();else{var t=s.a.parse(location.href,!0),r=t.query;if(r.server=r.server||window.server,r.server){r.server.indexOf("http")<0&&(r.server="http://"+r.server);var a=s.a.parse(r.server);t.host=a.host,t.pathname=a.pathname,t.protocol=a.protocol,t.port=a.port}var o=t.host;/\.[^/\\]+$/.test(t.pathname)?t._p=l.a.dirname(t.pathname):t._p=t.pathname;var i=o+t._p;".app"==l.a.extname(t.pathname)&&(i+="/"+l.a.basename(t.pathname)),n=window.socket=c()(i,{reconnectionAttempts:3,transports:["websocket"]}),n.on("statechanged",(function(e){var t=window.v.$store.state;if(e.user){var r=e.user;for(var n in r)"whatsup"==n&&t.me.whatsup!=r.whatsup&&p.$emit("whatsupchgd",r.whatsup,t.me.whatsup),t.me[n]=r[n];d["a"].Account({accountId:t.me.phone,accountName:t.me.name,gender:-1})}e.history&&(t.history=e.history),e.orders&&(t.orders=e.orders),e.countdown&&(t.countdown=e.countdown),e.period&&(t.period=e.period),e.status&&(t.status=e.status)})),n.on("gameresult",(function(e){var t=window.v.$store.state;t.history.push(e.history),t.history.length>50&&t.history.splice(0,40),e.status&&(t.status=status);for(var r=t.orders.length-1;r>=0;r--){var n=t.orders[r];if(n.game.period!=e.history.period)break;var a=n;a.game.price=e.history.price,t.orders.splice(r,1,a);var o=h(a);o&&d["a"].onReward(o,"投注".concat(a.select,"获胜"))}})),n.on("incbalance",(function(e){var t=window.v.$store.state;t.me.balance+=e})),n.on("orderchanged",(function(e){var t=window.v.$store.state,r=t.orders.find((function(t){return t.id==e.id}));t.orders[r]=e})),n.on("connect",(function(){p.$emit("connect",n)})).on("error",console.error.bind(console,"err")).on("connect_error",(function(){p.$emit("relogin")})).on("connect_timeout",(function(){p.$emit("relogin")})).on("disconnect",(function(){p.$emit("relogin")})).on("notify",(function(e){p.$emit("notify",e)})).on("kicked",(function(e){p.$emit("kicked",e)}))}return"function"==typeof e&&e(n),n}function m(e){return e=String(e),Number(e.substr(e.length-1,1))}function h(e){var t,r=m(e.game.price);return"Green"==e.select&&r%2==1?(t=5==r?1.5*(e.betting-e.fee):2*(e.betting-e.fee),t):"Red"==e.select&&r%2==0?(t=0==r?1.5*(e.betting-e.fee):2*(e.betting-e.fee),t):"Violet"!=e.select||0!=r&&5!=r?e.select==r?(t=9*(e.betting-e.fee),t):0:(t=4.5*(e.betting-e.fee),t)}},"8aaf":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return o}));r("99af"),r("a9e3");Number.prototype.pad=function(e){var t=String(this);while(t.length<(e||2))t="0"+t;return t};var n=function(e){return e=new Date(e),"".concat(e.getFullYear().pad(4),"-").concat((e.getMonth()+1).pad(),"-").concat(e.getDate().pad()," ").concat(e.getHours().pad(),":").concat(e.getMinutes().pad(),":").concat(e.getSeconds().pad())},a=function(e){return e=new Date(e),"".concat(e.getHours().pad(),":").concat(e.getMinutes().pad(),":").concat(e.getSeconds().pad())},o=function(e){return null==e?0:e}},9150:function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),a=r("8c4f"),o=r("2f62"),s=r("5f5b"),i=r("0759"),l=r("7386"),u=(r("f9e3"),r("2dd8"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("sys-menu"),r("router-view")],1)}),c=[],d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"info",fixed:"top",sticky:""}},[r("b-navbar-brand",{attrs:{href:"#"}},[e._v("Admin")]),r("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),r("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[r("b-navbar-nav",{},[r("b-nav-item",{attrs:{to:"serverlet"}},[e._v("服务器设置")]),r("b-nav-item",{attrs:{to:"gameset"}},[e._v("游戏监控")]),r("b-nav-item",{attrs:{to:"accounts"}},[e._v("管理员")]),r("b-nav-item",{attrs:{to:"userMoney"}},[e._v("用户管理")]),r("b-nav-item",{attrs:{to:"orders"}},[e._v("充值订单")]),r("b-nav-item",{attrs:{to:"withdrawOrders"}},[e._v("提现订单")]),r("b-nav-item",{attrs:{to:"logout"}},[e._v("注销")])],1)],1)],1)],1)},f=[],p={name:"MENU"},b=p,m=r("2877"),h=Object(m["a"])(b,d,f,!1,null,null,null),g=h.exports,v={name:"Admin",components:{SysMenu:g}},w=v,y=Object(m["a"])(w,u,c,!1,null,null,null),k=y.exports,_=r("7ed9"),x=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-form",[r("b-tabs",[r("b-tab",{attrs:{title:"运行参数"}},[r("b-form-group",{attrs:{label:"在线人数"}},[r("p",[e._v(e._s(e.online))])]),r("b-form-group",{attrs:{label:"获胜策略"}},[r("b-form-radio-group",{attrs:{stacked:"",options:[{text:"随机",value:0},{text:"必胜",value:1}]},model:{value:e.strategy,callback:function(t){e.strategy=t},expression:"strategy"}},[r("b-form-radio",{attrs:{value:"2"}},[r("b-form-group",{attrs:{label:"指定结果","label-cols-sm":"4","invalid-feedback":e.spec_result_error,state:e.spec_result_state}},[r("b-form-input",{attrs:{placeholder:"输入7,8,9，3盘结果分别是7,8,9",state:e.spec_result_state},on:{update:function(t){e.strategy=2}},model:{value:e.spec_result,callback:function(t){e.spec_result=t},expression:"spec_result"}})],1)],1)],1)],1),r("b-form-group",{attrs:{label:"下注抽水"}},[r("b-form-input",{attrs:{formatter:e.feeFormatter},model:{value:e.feeRate,callback:function(t){e.feeRate=t},expression:"feeRate"}})],1),r("b-form-group",{attrs:{label:"取现抽水","invalid-feedback":"格式: n%+d",state:e.wfState}},[r("b-form-input",{attrs:{state:e.wfState},model:{value:e.withdrawFee,callback:function(t){e.withdrawFee=t},expression:"withdrawFee"}})],1)],1),r("b-tab",{attrs:{title:"老师配置"}},[r("b-form-group",{attrs:{label:"老师WhatsUp"}},[r("b-form-input",{model:{value:e.whatsup,callback:function(t){e.whatsup=t},expression:"whatsup"}})],1)],1)],1),r("b-button",{attrs:{block:"",variant:"info"},on:{click:e.submit}},[e._v("Submit")])],1)},P=[],$=(r("a15b"),r("fb6a"),r("a9e3"),r("ac1f"),r("1276"),r("2d71")),O={name:"serverlet",components:{},data:function(){return{online:null,strategy:0,spec_result:null,feeRate:"2%",withdrawFee:"5%",luckyshopee:{sms_url:null,pay_url:null,withdraw_url:null,check_withdraw_url:null,check_fund_url:null,appId:null,appKey:null,appChannel:null},whatsup:null}},computed:{spec_result_state:function(){if(2!=this.strategy)return null;if(!this.spec_result)return null;for(var e=this.spec_result.split(/[\s,，]+/),t=0;t<e.length;t++){var r=e[t],n=Number(r);if(""===r||null==r)return!1;if(isNaN(n))return!1;if(n<0||n>9)return!1}return!0},spec_result_error:function(){if(!this.spec_result)return null;var e=this.spec_result.split(/[\s,，]+/),t=e[e.length-1];if(""==t||null==t)return"结尾必须是数字";for(var r=0;r<e.length;r++){var n=e[r],a=Number(n);if(""===n||null==n)return"第".concat(r+1,"个数字是空的");if(isNaN(a))return"第".concat(r+1,"个不是数字");if(a<0||a>9)return"第".concat(r+1,"个数字不在0～9之间")}return null},wfState:function(){if(0==this.withdrawFee.length)return!1;var e=this.withdrawFee.split("%");if(e.length>2)return!1;for(var t=0;t<e.length;t++)if(e[t]=Number(e[t]),isNaN(e[t]))return!1;return!(2==e.length&&e[0]>=100)}},methods:{feeFormatter:function(e){return"%"==e.slice(-1)?e:e+"%"},submit:function(){var e=this;if(this.wfState){var t=this.strategy,r=Number(this.feeRate.slice(0,-1))/100,n=this.whatsup,a=function(){var t=e.withdrawFee.split("%");if(t.length>2)return!1;for(var r=0;r<t.length;r++)if(t[r]=Number(t[r]),isNaN(t[r]))return!1;return 1==t.length&&"%"!=e.withdrawFee.slice(-1)&&(t[1]=t[0],t[0]=0),t}();if(a){if(2==t){if(!this.spec_result_state)return;t=void 0;var o=this.spec_result.split(/[\s,，]+/)}Object($["b"])((function(e){e.emit("setsettings",{strategy:t,temp_result:o,feeRate:r,withdrawPercent:(a[0]||0)/100,withdrawFixed:a[1]||0,whatsup:n},(function(e){if(e)return alert(e);alert("success")}))}))}}}},mounted:function(){var e=this;Object($["b"])((function(t){t.emit("getsettings",(function(t,r){if(t)return alert(t);var n="";r.withdrawPercent&&(n+=100*r.withdrawPercent+"%"),null!=r.withdrawFixed&&(n.length>0&&(n+="+"),n+=r.withdrawFixed),r.temp_result&&r.temp_result.length&&(r.spec_result=r.temp_result.join(","),r.strategy=2),r.withdrawFee=n,r.feeRate=100*r.feeRate+"%",Object.assign(e,r)}))}))}},j=O,q=Object(m["a"])(j,x,P,!1,null,null,null),S=q.exports,C=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-form",[r("b-form-group",{staticClass:"mt-1",attrs:{label:"用户手机/id"}},[r("b-input-group",{staticClass:"ml-1 mr-1"},[r("b-form-input",{attrs:{required:""},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}}),r("b-input-group-append",[r("b-button",{attrs:{type:"submit",variant:"info"},on:{click:e.findUser}},[e._v("Find")])],1)],1)],1)],1),r("div",{directives:[{name:"show",rawName:"v-show",value:Object.keys(e.userdata).length,expression:"Object.keys(userdata).length"}]},[r("b-form-group",{attrs:{label:"","label-cols":"4"},scopedSlots:e._u([{key:"label",fn:function(){return[r("span",[e._v("phone "),r("code",[e._v(e._s(e.userdata.phone))])])]},proxy:!0}])},[r("b-form-checkbox",{attrs:{name:"check-button",switch:""},model:{value:e.blocked,callback:function(t){e.blocked=t},expression:"blocked"}},[e._v(" 禁用账号 "),r("b",[e._v("(Blocked: "+e._s(e.blocked)+")")])])],1),r("b-form-group",{attrs:{label:"name","label-cols":"4"}},[r("b-form-input",{attrs:{readonly:""},model:{value:e.userdata.name,callback:function(t){e.$set(e.userdata,"name",t)},expression:"userdata.name"}})],1),r("b-form-group",{attrs:{label:"","label-cols":"4"},scopedSlots:e._u([{key:"label",fn:function(){return[r("span",[e._v("balance "),r("code",[e._v(e._s(e.userdata.balance||0))])])]},proxy:!0}])},[r("b-input-group",[r("b-form-input",{attrs:{id:"m_balance"}}),r("b-input-group-append",[r("b-button",{attrs:{variant:"info"},on:{click:e.modifyBalance}},[e._v("Add")])],1)],1)],1),r("b-form-group",{attrs:{label:"充值","label-cols":"4"}},[r("b-form-input",{attrs:{readonly:""},model:{value:e.userdata.recharge,callback:function(t){e.$set(e.userdata,"recharge",t)},expression:"userdata.recharge"}})],1),r("b-form-group",{attrs:{label:"下注","label-cols":"4"}},[r("b-form-input",{attrs:{readonly:""},model:{value:e.userdata.bet,callback:function(t){e.$set(e.userdata,"bet",t)},expression:"userdata.bet"}})],1),r("b-form-group",{attrs:{label:"银行","label-cols":"4"}},[r("b-card",[r("b-card-text",[e._v(e._s(e.bankCode))]),r("b-card-text",[e._v(e._s(e.accountName))]),r("b-card-text",[e._v(e._s(e.accountNo))]),r("b-card-text",[e._v(e._s(e.bankphone))]),r("b-button",{staticClass:"float-right",attrs:{variant:"danger"}},[e._v("删")])],1)],1),r("b-form-group",{attrs:{label:"注册IP","label-cols":"4"}},[r("b-form-input",{attrs:{readonly:""},model:{value:e.userdata.regIP,callback:function(t){e.$set(e.userdata,"regIP",t)},expression:"userdata.regIP"}})],1),r("b-form-group",{attrs:{label:"登录IP","label-cols":"4"}},[r("b-form-input",{attrs:{readonly:""},model:{value:e.userdata.lastIP,callback:function(t){e.$set(e.userdata,"lastIP",t)},expression:"userdata.lastIP"}})],1),r("b-form-group",{attrs:{label:"活动","label-cols":"4"}},[r("b-form-group",{attrs:{label:"拜师送金","label-size":"sm","label-cols":"4"}},[r("b-button",{attrs:{size:"sm",variant:"primary",disabled:!e.enable_baishi4500},on:{click:e.handle_promotion_baishi}},[e._v("完成")])],1)],1),r("b-form-group",{attrs:{label:"充值记录"}},[r("b-table",{ref:"rechargeList",attrs:{id:"recharge-list","show-empty":"",small:"",items:e.queryBills,fields:e.recharge.fields,"sort-by":"time","sort-desc":!0,"per-page":e.recharge.perPage,"current-page":e.recharge.currentPage}}),r("b-pagination",{staticClass:"float-right",attrs:{"total-rows":e.recharge.total,"per-page":e.recharge.perPage,"aria-controls":"recharge-list"},model:{value:e.recharge.currentPage,callback:function(t){e.$set(e.recharge,"currentPage",t)},expression:"recharge.currentPage"}})],1),r("b-form-group",{attrs:{label:"提现记录"}},[r("b-table",{ref:"withdrawList",attrs:{id:"withdraw-list","show-empty":"",small:"",items:e.queryWithdrawal,fields:e.withdraw.fields,"sort-by":"time","sort-desc":!0,"per-page":e.withdraw.perPage,"current-page":e.withdraw.currentPage}}),r("b-pagination",{staticClass:"float-right",attrs:{"total-rows":e.withdraw.total,"per-page":e.withdraw.perPage,"aria-controls":"withdraw-list"},model:{value:e.withdraw.currentPage,callback:function(t){e.$set(e.withdraw,"currentPage",t)},expression:"withdraw.currentPage"}})],1)],1)],1)},A=[],I=(r("caad"),r("9129"),r("2532"),r("3835")),D=r("6e87"),N=r("136a"),E=r("8aaf"),R=Object($["b"])(),T={name:"userMan",computed:{blocked:{get:function(){return new Date(this.userdata.block)>new Date},set:function(e){var t=this,r=e?new Date("2100/01/01"):new Date("1970/01/01");R.emit("disableuser",t.phone,r,(function(e){if(e)return alert(e);t.$set(t.userdata,"block",r)}))}},paytm_ids:function(){return Array.isArray(this.userdata.paytm_id)?this.userdata.paytm_id:[this.userdata.paytm_id]},bankCode:function(){return Object(D["get"])(this.userdata,"bankinfo.bankCode")},accountName:function(){return Object(D["get"])(this.userdata,"bankinfo.accountName")},accountNo:function(){return Object(D["get"])(this.userdata,"bankinfo.accountNo")},bankphone:function(){return Object(D["get"])(this.userdata,"bankinfo.phone")}},data:function(){return{phone:null,userdata:{bankInfo:{}},enable_baishi4500:!1,recharge:{total:0,rows:null,perPage:15,currentPage:1,fields:[{key:"time",label:"时间",formatter:E["a"],sortable:!0},{key:"snapshot.balance",label:"资金",formatter:E["b"]},{key:"money",label:"充值"}]},withdraw:{total:0,rows:null,perPage:15,currentPage:1,fields:[{key:"time",label:"时间",formatter:E["a"],sortable:!0},{key:"snapshot.bankName",label:"银行"},{key:"snapshot.accountNo",label:"账号"},{key:"snapshot.accountName",label:"Owner"},{key:"snapshot.balance",label:"资金",formatter:E["b"]},{key:"snapshot.amount",label:"提现"},{key:"snapshot.fee",label:"手续费"},{key:"result.tradeStatus",label:"结果"}]}}},methods:{manipulatedata:function(e){var t=this;for(var r in e)t.$set(t.userdata,r,e[r])},findUser:function(e){if(e.preventDefault(),this.phone){var t=this.phone,r=this;R.emit("$list",{target:"users",query:{phone:t}},(function(e,n){var a=Object(I["a"])(n,1),o=a[0];if(e)return alert(e);r.manipulatedata(o),R.emit("list",{target:"promotions",query:{phone:t}},(function(e,t){e||t.includes("baishi4500")&&(r.enable_baishi4500=!0)}))})),this.$refs.rechargeList.refresh(),this.$refs.withdrawList.refresh()}},queryBills:function(e,t){var r=this;R.emit("$list",{target:"bills",query:{phone:r.phone},offset:r.recharge.perPage*(r.recharge.currentPage-1),limit:r.recharge.perPage,sort:e.sortBy,order:e.sortDesc?"desc":"asc"},(function(e,n){var a=n.rows,o=n.total;r.recharge.total=o,t(a)}))},queryWithdrawal:function(e,t){var r=this;R.emit("$list",{target:"withdraw",query:{phone:r.phone},offset:r.withdraw.perPage*(r.withdraw.currentPage-1),limit:r.withdraw.perPage,sort:e.sortBy,order:e.sortDesc?"desc":"asc"},(function(e,n){var a=n.rows,o=n.total;r.withdraw.total=o,t(a)}))},modifyBalance:function(){var e=Number(document.getElementById("m_balance").value);if(!Number.isNaN(e)){var t=this.phone,r=this;R.emit("modifybalance",t,e,(function(n,a){if(n)return alert(n);r.manipulatedata(a),N["a"].Account({accountId:t}),N["a"].onReward(e,"管理员操作")}))}},chgPaytm:function(e){var t=e.target.dataset.idx,r=document.getElementById("paytm_id".concat(t)).value;Array.isArray(this.userdata.paytm_id)||(t=null);var n=this;R.emit("changepaytm",n.phone,t,r,(function(e,t){if(e)return alert(e);n.manipulatedata(t)}))},delPaytm:function(e){var t=e.target.dataset.idx,r=document.getElementById("paytm_id".concat(t)).value,n=this;R.emit("delpaytm",n.phone,r,(function(e){if(e)return alert(e);n.$set(n.userdata,"paytm_id",null)}))},handle_promotion_baishi:function(e){e.preventDefault();var t=this;R.emit("upd",{target:"promotions",query:{phone:t.phone},name:"baishi4500"},(function(e){if(e)return alert(e);t.userdata.balance+=4500,t.enable_baishi4500=!1,N["a"].Account({accountId:t.phone}),N["a"].onReward(4500,"拜师送4500"),N["a"].onEvent("baishi4500",JSON.stringify({user:t.phone,reward:4500}))}))}},mounted:function(){this.userdata={}}},B=T,F=Object(m["a"])(B,C,A,!1,null,null,null),M=F.exports,L=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-form",{attrs:{inline:""}},[r("b-form-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{placeholder:"id"},model:{value:e.query.phone,callback:function(t){e.$set(e.query,"phone",t)},expression:"query.phone"}}),r("label",{attrs:{for:"example-datepicker"}},[e._v("From")]),r("b-form-datepicker",{staticClass:"mb-2 mr-sm-1 mb-sm-0",attrs:{"value-as-date":"","reset-button":""},model:{value:e.query.from,callback:function(t){e.$set(e.query,"from",t)},expression:"query.from"}}),r("label",{attrs:{for:"example-datepicker"}},[e._v("To")]),r("b-form-datepicker",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{"value-as-date":"","reset-button":""},model:{value:e.query.to,callback:function(t){e.$set(e.query,"to",t)},expression:"query.to"}}),r("b-button",{staticClass:"mb-1 mb-sm-0",attrs:{variant:"primary"},on:{click:e.refreshData}},[e._v("查")]),r("label",{staticClass:"float-right"},[e._v("可用资金"),r("code",[e._v(e._s(e.fund))])])],1),r("b-table",{ref:"withdrawList",attrs:{id:"withdraw-list","show-empty":"",small:"",items:e.queryWithdrawal,fields:e.withdraw.fields,"sort-by":"time","sort-desc":!0,"per-page":e.withdraw.perPage,"current-page":e.withdraw.currentPage},scopedSlots:e._u([{key:"cell(actions)",fn:function(t){return[r("b-button-group",{attrs:{size:"sm"}},[r("b-button",{attrs:{variant:"primary",disabled:!!t.item.tradeno||!!t.item.result},on:{click:function(r){return e.approval(t.item)}}},[e._v("提")]),r("b-button",{attrs:{variant:"danger",disabled:!!t.item.tradeno||!!t.item.result},on:{click:function(r){return e.refund(t.item)}}},[e._v("退")])],1)]}},{key:"custom-foot",fn:function(t){return e._l(t.fields,(function(t,n){return r("b-td",{key:n},["id"==t.label?r("b",{staticClass:"text-bold"},[e._v("Total")]):"提现"==t.label?r("b",{staticClass:"text-bold"},[e._v(e._s(e.sum.amount-e.sum.fee))]):r("b")])}))}}])}),r("b-pagination",{staticClass:"float-right",attrs:{"total-rows":e.withdraw.total,"per-page":e.withdraw.perPage,"aria-controls":"withdraw-list"},model:{value:e.withdraw.currentPage,callback:function(t){e.$set(e.withdraw,"currentPage",t)},expression:"withdraw.currentPage"}})],1)},U=[],G=(r("13d5"),r("b64b"),Object($["b"])()),z=function(e,t){return Array.isArray(t)?Object.keys(e).reduce((function(r,n){return t.includes(e[n])&&(r[n]=e[n]),r}),{}):"function"===typeof t?Object.keys(e).reduce((function(r,n){return t(e[n])&&(r[n]=e[n]),r}),{}):null},W={name:"withdrawOrders",data:function(){return{fund:null,query:{phone:null,from:null,end:null},sum:{},withdraw:{total:0,rows:null,perPage:25,currentPage:1,fields:[{key:"phone",label:"id"},{key:"time",label:"时间",formatter:E["a"],sortable:!0},{key:"snapshot.bankName",label:"银行"},{key:"snapshot.accountNo",label:"账号"},{key:"snapshot.accountName",label:"Owner"},{key:"snapshot.balance",label:"资金",formatter:E["b"]},{key:"snapshot.amount",label:"提现"},{key:"snapshot.fee",label:"手续费"},{key:"tradeno",label:"通道订单"},{key:"result.tradeStatus",label:"结果"},{key:"actions",label:"操作"}]}}},methods:{refreshData:function(){this.$refs.withdrawList.refresh()},queryWithdrawal:function(e,t){var r=this;G.emit("$list",{target:"withdraw",query:z(r.query,(function(e){return null!=e})),offset:r.withdraw.perPage*(r.withdraw.currentPage-1),limit:r.withdraw.perPage,sort:e.sortBy,order:e.sortDesc?"desc":"asc"},(function(e,n){var a=n.rows,o=n.total,s=n.sum;r.withdraw.total=o,r.sum=s||{},t(a)})),G.emit("$fund",(function(e,t){e||(r.fund=t)}))},approval:function(e){var t=this;G.emit("$approval_order",e._id,(function(e){if(e)return alert(e);t.refreshData()}))},refund:function(e){var t=this;G.emit("$refund",e._id,(function(e){if(e)return alert(e);t.refreshData()}))}}},J=W,H=Object(m["a"])(J,L,U,!1,null,null,null),V=H.exports,K=r("9848"),Y=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-alert",{attrs:{dismissible:"",show:e.errStatus,variant:"warning"},on:{dismissed:e.errDismissed}},[e._v(e._s(e.err))]),r("b-tabs",[r("b-tab",{attrs:{title:"管理员账号"}},[r("b-button-toolbar",[r("b-button-group",{staticClass:"float-right",attrs:{size:"sm"}},[r("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-create",modifiers:{"modal-create":!0}}]},[r("b-icon-person-plus"),e._v(" Create Account")],1)],1)],1),r("b-table",{attrs:{"show-empty":"",small:"",stacked:"md",items:e.items,fields:e.fields},scopedSlots:e._u([{key:"cell(actions)",fn:function(t){return["admin"!=t.item.phone?r("b-button",{attrs:{size:"sm"},on:{click:function(r){return e.delaccount(t.item)}}},[e._v("delete")]):e._e(),r("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-chgpwd",modifiers:{"modal-chgpwd":!0}}],attrs:{size:"sm"},on:{click:function(r){e.account.phone=t.item.phone}}},[e._v("reset password")])]}}])})],1)],1),r("b-modal",{attrs:{id:"modal-create",title:"新建管理员","ok-only":"","ok-title":"Create"},on:{ok:e.addaccount,show:e.clearData}},[r("b-form",[r("b-form-group",{attrs:{label:"账号"}},[r("b-input",{model:{value:e.account.phone,callback:function(t){e.$set(e.account,"phone",t)},expression:"account.phone"}})],1),r("b-form-group",{attrs:{label:"密码"}},[r("b-input",{model:{value:e.account.pwd,callback:function(t){e.$set(e.account,"pwd",t)},expression:"account.pwd"}})],1),r("b-form-group",{attrs:{label:"身份"}},[r("b-form-select",{attrs:{options:[{value:null,text:"选择身份"},"admin","manager","superuser"]},model:{value:e.account.acl,callback:function(t){e.$set(e.account,"acl",t)},expression:"account.acl"}})],1)],1)],1),r("b-modal",{attrs:{id:"modal-chgpwd",title:"重设密码","ok-only":"","ok-title":"Reset"},on:{ok:e.chgpwd,show:e.clearChgPwd}},[r("b-form",[r("b-form-group",{attrs:{label:e.account.phone+"设置新密码"}},[r("b-input",{model:{value:e.account.pwd,callback:function(t){e.$set(e.account,"pwd",t)},expression:"account.pwd"}})],1)],1)],1)],1)},Q=[],X=r("5530"),Z={name:"Accounts",components:{BIconPersonPlus:l["q"]},data:function(){return{errStatus:null,err:null,account:{phone:null,pwd:null,acl:null},items:[],fields:[{key:"phone",label:"账号"},{key:"acl",label:"身份",formatter:function(e,t,r){return e||(r.isAdmin?"Admin":"")}},{key:"regTime",label:"注册时间",formatter:E["a"]},{key:"actions",label:"操作"}]}},methods:{showerr:function(e){this.errStatus="access denied"!=e||3,this.err=e},clearData:function(){this.account.phone=null,this.account.pwd=null,this.account.acl=null},clearChgPwd:function(){this.account.pwd=null},chgpwd:function(){this.account.pwd&&this.updaccount(this.account.phone,{pwd:this.account.pwd})},errDismissed:function(){"access denied"==this.err&&we.push("/login"),this.err=null,this.errStatus=null},refreshData:function(){var e=Object($["b"])(),t=this;e.emit("$list",{target:"users",query:{isAdmin:!0}},(function(e,r){if(e)return t.showerr(e);t.items=r}))},delaccount:function(e){var t=Object($["b"])(),r=this;t.emit("$del",{target:"users",query:{phone:e.phone}},(function(e){if(e)return r.showerr(e);r.refreshData()}))},addaccount:function(e){if(!this.account.phone||!this.account.pwd||!this.account.acl)return e.preventDefault();var t=Object($["b"])(),r=this;t.emit("$create",{target:"users",content:Object(X["a"])(Object(X["a"])({},this.account),{},{isAdmin:!0})},(function(e){if(e)return r.showerr(e);r.refreshData()}))},updaccount:function(e,t){var r=Object($["b"])();r.emit("$upd",{target:"users",query:{phone:e},content:t},(function(e){if(e)return self.showerr(e);alert("success")}))}},mounted:function(){this.refreshData()}},ee=Z,te=Object(m["a"])(ee,Y,Q,!1,null,null,null),re=te.exports,ne=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-alert",{attrs:{dismissible:"",show:!!e.err,variant:"warning"},on:{dismissed:e.errDismissed}},[e._v(e._s(e.err))]),r("b-form-group",{attrs:{label:"在线"}},[r("b-table",{attrs:{id:"online-list-table","show-empty":"",small:"",stacked:"md",items:e.users,fields:e.userfields,"per-page":e.perPage,"current-page":e.currentPage},scopedSlots:e._u([{key:"cell(recharge)",fn:function(t){return[e._v(" "+e._s(t.item.recharge)+" "),t.item.rechargeTime?r("span",[e._v(" /"+e._s(e.dateTimeString(t.item.rechargeTime))+" ")]):e._e()]}},{key:"cell(actions)",fn:function(t){return[t.item.isAdmin?e._e():r("b-button",{attrs:{size:"sm"},on:{click:function(r){return e.kick(t.item)}}},[e._v("kick")])]}}])}),r("b-pagination",{attrs:{"total-rows":e.users?e.users.length:0,"per-page":e.perPage,"aria-controls":"online-list-table"},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1),r("b-form-group",{attrs:{label:""},scopedSlots:e._u([{key:"label",fn:function(){return[r("b-list-group",{attrs:{flush:""}},[r("b-list-group-item",{staticClass:"d-flex justify-content-between align-items-center"},[e._v(" Period: "+e._s(e.period)+" "),r("b-badge",{attrs:{variant:"primary",pill:""}},[e._v(e._s(e.countdown))])],1)],1)]},proxy:!0}])},[r("b-table",{attrs:{"show-empty":"",small:"",items:e.setdata},scopedSlots:e._u([{key:"cell()",fn:function(t){return[0==t.index?r("span",[e._v(e._s(t.value))]):r("div",e._l(t.value,(function(t,n){return r("p",{key:n},[e._v(e._s(t.name||t.id)+":"+e._s(t.bet))])})),0)]}}])})],1)],1)},ae=[],oe=(r("c740"),r("4160"),r("a434"),r("b0c0"),r("159b"),Object($["b"])()),se={name:"GameSet",computed:Object(X["a"])({setdata:function(){var e={},t={Green:0,Violet:0,Red:0,0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0};return this.contracts?(this.contracts.forEach((function(r){e[r.select]||(e[r.select]=[]),e[r.select].push({id:r.phone,name:r.name,bet:r.betting}),null==t[r.select]?t[r.select]=r.betting:t[r.select]+=r.betting})),[t,e]):[t]}},Object(o["b"])({status:function(e){return e.status},period:function(e){return e.period},countdown:function(e){return Math.floor(e.countdown/60).pad()+":"+(e.countdown%60).pad()}})),data:function(){return{err:null,perPage:15,currentPage:1,users:null,userfields:[{key:"phone",label:"id"},"name",{key:"balance",label:"资金"},{key:"recharge",label:"充值"},{key:"bet",label:"投注"},{key:"win",label:"获利"},{key:"regTime",label:"注册时间",formatter:E["a"]},{key:"actions",label:"操作"}],contracts:null}},created:function(){var e=this;oe.on("userin",(function(t){Array.isArray(e.users)&&e.users.push(t)})).on("userout",(function(t){if(Array.isArray(e.users)){var r=e.users.findIndex((function(e){return e.phone==t}));r>=0&&e.users.splice(r,1)}})).on("contract",(function(t){Array.isArray(e.contracts)&&e.contracts.push(t)})).on("statechanged",(function(t){null!=t.period&&t.period!=e.period&&(e.contracts=[])})),oe.emit("$list",{target:"online"},(function(t,r){if(t)return e.showerr(t);e.users=r})),oe.emit("$list",{target:"contracts"},(function(t,r){if(t)return e.showerr(t);e.contracts=r}))},methods:{showerr:function(e){this.err=e},errDismissed:function(){"access denied"==this.err&&we.push("/login"),this.err=null},kick:function(e){var t=this;oe.emit("kick",e.phone,(function(e){if(e)return t.showerr(e);alert("done")}))}}},ie=se,le=Object(m["a"])(ie,ne,ae,!1,null,null,null),ue=le.exports,ce=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-form",{attrs:{inline:""}},[r("b-form-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{placeholder:"id"},model:{value:e.query.phone,callback:function(t){e.$set(e.query,"phone",t)},expression:"query.phone"}}),r("label",{attrs:{for:"example-datepicker"}},[e._v("From")]),r("b-form-datepicker",{staticClass:"mb-2 mr-sm-1 mb-sm-0",attrs:{"value-as-date":"","reset-button":""},model:{value:e.query.from,callback:function(t){e.$set(e.query,"from",t)},expression:"query.from"}}),r("label",{attrs:{for:"example-datepicker"}},[e._v("To")]),r("b-form-datepicker",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{"value-as-date":"","reset-button":""},model:{value:e.query.to,callback:function(t){e.$set(e.query,"to",t)},expression:"query.to"}}),r("label",[e._v("订单状态")]),r("b-form-select",{attrs:{options:[{value:!0,text:"已完成"},{value:!1,text:"未完成"},{value:null,text:"所有"}]},model:{value:e.query.used,callback:function(t){e.$set(e.query,"used",t)},expression:"query.used"}}),r("b-button",{staticClass:"mb-1 mb-sm-0",attrs:{variant:"primary"},on:{click:e.refreshData}},[e._v("查")])],1),r("b-table",{ref:"orderList",attrs:{id:"order-list","show-empty":"",small:"",items:e.queryorder,fields:e.order.fields,"sort-by":"time","sort-desc":!0,"per-page":e.order.perPage,"current-page":e.order.currentPage},scopedSlots:e._u([{key:"custom-foot",fn:function(t){return e._l(t.fields,(function(t,n){return r("b-td",{key:n},["id"==t.label?r("b",[e._v("Total")]):"金额"==t.label?r("b",[e._v(e._s(e.sum.money))]):r("b")])}))}}])}),r("b-pagination",{staticClass:"float-right",attrs:{"total-rows":e.order.total,"per-page":e.order.perPage,"aria-controls":"order-list"},model:{value:e.order.currentPage,callback:function(t){e.$set(e.order,"currentPage",t)},expression:"order.currentPage"}})],1)},de=[],fe=Object($["b"])(),pe=function(e,t){return Array.isArray(t)?Object.keys(e).reduce((function(r,n){return t.includes(e[n])&&(r[n]=e[n]),r}),{}):"function"===typeof t?Object.keys(e).reduce((function(r,n){return t(e[n])&&(r[n]=e[n]),r}),{}):null},be={name:"orders",data:function(){return{fund:null,query:{phone:null,from:null,end:null,used:!0},sum:{},order:{total:0,rows:null,perPage:25,currentPage:1,fields:[{key:"phone",label:"id"},{key:"time",label:"时间",formatter:E["a"],sortable:!0},{key:"snapshot.balance",label:"充值前",formatter:E["b"]},{key:"money",label:"金额"},{key:"used",label:"结果"}]}}},methods:{refreshData:function(){this.$refs.orderList.refresh()},queryorder:function(e,t){var r=this;fe.emit("$list",{target:"bills",query:pe(r.query,(function(e){return null!=e})),offset:r.order.perPage*(r.order.currentPage-1),limit:r.order.perPage,sort:e.sortBy,order:e.sortDesc?"desc":"asc"},(function(e,n){var a=n.rows,o=n.total,s=n.sum;r.order.total=o,r.sum=s||{},t(a)}))}}},me=be,he=Object(m["a"])(me,ce,de,!1,null,null,null),ge=he.exports;function ve(e,t,r){var n=$["a"].loggedIn();n?r():r({path:"/login",query:{redirect:e.fullPath}})}var we=new a["a"]({routes:[{path:"/",component:S,beforeEnter:ve},{path:"/serverlet",component:S,beforeEnter:ve},{path:"/userMoney",component:M,beforeEnter:ve},{path:"/accounts",component:re,beforeEnter:ve},{path:"/gameset",component:ue,beforeEnter:ve},{path:"/orders",component:ge,beforeEnter:ve},{path:"/withdrawOrders",component:V,beforeEnter:ve},{path:"/login",component:K["a"]},{path:"/logout",beforeEnter:function(e,t,r){$["a"].logout(),r("/")}}]});we.onReady((function(){ke()}));var ye=Object($["b"])();function ke(){}_["b"].$on("relogin",ke),_["b"].$on("kicked",(function(e){localStorage.adminAccount=void 0,localStorage.adminToken=void 0,ye.isLogined=void 0,alert(e),we.push("/login")})),n["default"].use(a["a"]),n["default"].use(s["a"]),n["default"].component("BIcon",i["a"]),n["default"].component("BIconChevronRight",l["i"]),n["default"].component("BIconChevronLeft",l["h"]),n["default"].component("BIconBoxArrowInLeft",l["b"]),n["default"].use(o["a"]),n["default"].config.productionTip=!1;var _e=new o["a"].Store({state:{me:{balance:null,id:null,paytm_id:null},countdown:null,period:null,history:[],orders:[],status:null},mutations:{countdown:function(e){e.countdown>0&&e.countdown--,e.countdown<=30&&(e.status="stop_betting")}}});setInterval((function(){_e.commit("countdown")}),1e3),window.v=new n["default"]({router:we,el:"#app",store:_e,$eventBus:new n["default"],render:function(e){return e(k)}})},9848:function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-form",{staticClass:"mt-5"},[r("b-form-group",{attrs:{id:"login-phone"}},[r("b-form-input",{attrs:{required:"",placeholder:"User name"},model:{value:e.mobile,callback:function(t){e.mobile=t},expression:"mobile"}})],1),r("b-form-group",[r("b-form-input",{attrs:{type:"password",required:"",placeholder:"Password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),e.regmode?r("b-form-group",[r("b-button",{attrs:{type:"submit",variant:"primary",block:""},on:{click:e.reg}},[e._v("Sign up")]),r("p",[e._v("首次使用，请注册管理员账号，一旦注册不可更改")])],1):r("b-button",{attrs:{type:"submit",variant:"primary",block:""},on:{click:e.dologin}},[e._v("Sign in")])],1)},a=[],o=(r("ac1f"),r("5319"),r("2d71")),s=r("6821"),i=r.n(s),l=Object(o["b"])(),u={name:"login",data:function(){return{mobile:null,password:null,logged:!1,longop:!1,regmode:!1}},methods:{loggedIn:function(){return!!this.logged},reg:function(e){e.preventDefault(),this.longop=!0;var t=this.mobile,r=this.password,n=this;function a(){n.longop=!1,l.off("reconnect_failed",a),alert("Can not reach the server")}l.on("reconnect_failed",a),l.emit("regadmin",{phone:t,pwd:r},(function(e,r){n.handlelogin(e,t,r),l.off("reconnect_failed",a)}))},dologin:function(e){e.preventDefault(),this.longop=!0;var t=this.mobile,r=this.password,n=this;function a(){n.longop=!1,l.off("reconnect_failed",a),alert("Can not reach the server")}l.on("reconnect_failed",a),l.emit("salt",t,(function(e,o){if(e)return n.longop=!1,void alert(e);l.emit("login",{phone:t,pwd:i()(""+o+r)},(function(e,r){n.handlelogin(e,t,r),l.off("reconnect_failed",a)}))}))},handlelogin:function(e,t,r){if(this.longop=!1,e)return alert(e);localStorage.adminAccount=t,localStorage.adminToken=r,l.isLogined=!0;var n=this.$router.currentRoute.query.redirect;n?this.$router.replace(n):this.$router.replace("/serverlet")}},mounted:function(){var e=this;l.emit("adminexists",(function(t,r){if(t)return alert(t);e.regmode=!r,e.mobile="admin"}))}},c=u,d=r("2877"),f=Object(d["a"])(c,n,a,!1,null,null,null);t["a"]=f.exports}});