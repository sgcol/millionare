(function(e){function t(t){for(var r,i,s=t[0],c=t[1],u=t[2],d=0,p=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&p.push(o[i][0]),o[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(p.length)p.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={admin:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;a.push([2,"chunk-vendors"]),n()})({0:function(e,t){},2:function(e,t,n){e.exports=n("9150")},"7ed9":function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m}));n("7db0"),n("c975"),n("a15b"),n("a434"),n("a9e3"),n("4d63"),n("ac1f"),n("25f0"),n("5319"),n("1276");var r,o=n("2b0e"),a=n("0b16"),i=n.n(a),s=n("df7c"),c=n.n(s),u=n("89a4"),l=n("4bea"),d=n.n(l),p={getItem:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[-.+*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,t,n,r,o,a){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var i="";if(n)switch(n.constructor){case Number:i=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:i="; expires="+n;break;case Date:i="; expires="+n.toUTCString();break}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+i+(o?"; domain="+o:"")+(r?"; path="+r:"")+(a?"; secure":""),!0},removeItem:function(e,t,n){return!(!e||!this.hasItem(e))&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(t?"; path="+t:""),!0)},hasItem:function(e){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[-.+*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=0;t<e.length;t++)e[t]=decodeURIComponent(e[t]);return e}},f=new o["default"];function m(e){if(r)r.disconnected&&r.connect();else{var t=i.a.parse(location.href,!0),n=t.query;if(n.server=n.server||window.server,n.server){n.server.indexOf("http")<0&&(n.server="http://"+n.server);var o=i.a.parse(n.server);t.host=o.host,t.pathname=o.pathname,t.protocol=o.protocol,t.port=o.port}var a=t.host,s=Object(u["a"])(a);if(s&&!s.errors&&0!=s.subdomain.indexOf("ws")){var l=s.subdomain.split(".");l[0]="ws",a=l.join(".")+"."+s.domain+"."+s.tld+(t.port?":"+t.port:"")}/\.[^/\\]+$/.test(t.pathname)?t._p=c.a.dirname(t.pathname):t._p=t.pathname;var p=a+t._p;".app"==c.a.extname(t.pathname)&&(p+="/"+c.a.basename(t.pathname)),r=window.socket=d()(p,{reconnectionAttempts:3,transports:["websocket"]}),r.on("statechanged",(function(e){var t=window.v.$store.state;if(e.user){var n=e.user;n._id&&(t.me._id=n._id),n.balance&&(t.me.balance=n.balance),n.paytm_id&&(t.me.paytm_id=n.paytm_id)}e.history&&(t.history=e.history),e.orders&&(t.orders=e.orders),e.countdown&&(t.countdown=e.countdown),e.period&&(t.period=e.period),e.status&&(t.status=e.status)})),r.on("gameresult",(function(e){var t=window.v.$store.state;t.history.push(e.history),t.history.length>50&&t.history.splice(0,40),e.status&&(t.status=status);for(var n=t.orders.length-1;n>=0;n--){var r=t.orders[n];if(r.game.period!=e.history.period)break;var o=r;o.game.price=e.history.price,t.orders.splice(n,1,o)}})),r.on("incbalance",(function(e){var t=window.v.$store.state;t.me.balance+=e})),r.on("orderchanged",(function(e){var t=window.v.$store.state,n=t.orders.find((function(t){return t.id==e.id}));t.orders[n]=e})),r.on("connect",(function(){f.$emit("connect",r)})).on("error",console.error.bind(console,"err")).on("connect_error",(function(){f.$emit("relogin")})).on("connect_timeout",(function(){f.$emit("relogin")})).on("disconnect",(function(){f.$emit("relogin")}))}return"function"==typeof e&&e(r),r}},9150:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=n("8c4f"),a=n("2f62"),i=n("5f5b"),s=n("0759"),c=n("7386"),u=(n("f9e3"),n("2dd8"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("sys-menu"),n("router-view")],1)}),l=[],d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"info",fixed:"top",sticky:""}},[n("b-navbar-brand",{attrs:{href:"#"}},[e._v("Admin")]),n("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),n("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[n("b-navbar-nav",{},[n("b-nav-item",{attrs:{to:"serverlet"}},[e._v("服务器设置")]),n("b-nav-item",{attrs:{to:"userMoney"}},[e._v("用户管理")]),n("b-nav-item",{attrs:{to:"logout"}},[e._v("注销")])],1)],1)],1)],1)},p=[],f={name:"MENU"},m=f,b=n("2877"),h=Object(b["a"])(m,d,p,!1,null,null,null),v=h.exports,g={name:"Admin",components:{SysMenu:v}},y=g,_=Object(b["a"])(y,u,l,!1,null,null,null),w=_.exports,k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("p",[e._v("在线人数"),n("span",[e._v(e._s(e.online))])]),n("b-form-group",{attrs:{label:"获胜策略"}},[n("b-form-radio-group",{attrs:{options:[{text:"随机",value:0},{text:"必胜",value:1}]},model:{value:e.strategy,callback:function(t){e.strategy=t},expression:"strategy"}})],1),n("b-form-group",{attrs:{label:"下注抽水"}},[n("b-form-input",{model:{value:e.feeRate,callback:function(t){e.feeRate=t},expression:"feeRate"}})],1),n("b-form-group",{attrs:{label:"取现抽水"}},[n("b-form-input",{model:{value:e.withdrawFee,callback:function(t){e.withdrawFee=t},expression:"withdrawFee"}})],1),n("b-form-group",[n("b-button",{attrs:{block:"",variant:"info"},on:{click:e.submit}},[e._v("Submit")])],1)],1)},x=[],O=(n("a9e3"),n("7ed9")),j={loggedIn:function(){return!!localStorage.admin_logged},logout:function(){delete localStorage.admin_logged},stdret:function(e){return function(t){t&&"access denied"==t?(delete localStorage.admin_logged,K.push("/login")):e.apply(null,arguments)}}},$=j.stdret,I={name:"serverlet",data:function(){return{online:null,strategy:null,feeRate:.02,withdrawFee:.05}},methods:{submit:function(){var e=this.strategy,t=Number(this.feeRate),n=Number(this.withdrawFee);Object(O["c"])((function(r){r.emit("setsettings",{strategy:e,feeRate:t,withdrawFee:n},(function(e){if(e)return alert(e);alert("success")}))}))}},mounted:function(){var e=this;Object(O["c"])((function(t){t.emit("getsettings",$((function(t,n){if(t)return alert(t);Object.assign(e,n)})))}))}},C=I,R=Object(b["a"])(C,k,x,!1,null,null,null),S=R.exports,E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-form",[n("b-form-group",{staticClass:"mt-1",attrs:{label:"用户手机"}},[n("b-input-group",{staticClass:"ml-1 mr-1"},[n("b-form-input",{attrs:{required:""},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}}),n("b-input-group-append",[n("b-button",{attrs:{type:"submit",variant:"info"},on:{click:e.findUser}},[e._v("Find")])],1)],1)],1)],1),n("b-form-group",{directives:[{name:"show",rawName:"v-show",value:Object.keys(e.userdata).length,expression:"Object.keys(userdata).length"}]},[n("b-container",{attrs:{fluid:""}},[n("b-row",{staticClass:"my-1"},[n("b-col",{attrs:{sm:"6"}},[n("label",{attrs:{for:"phone"}},[e._v("phone "),n("code",[e._v(e._s(e.userdata.phone))])])]),n("b-col",{attrs:{sm:"6"}},[n("b-form-checkbox",{attrs:{name:"check-button",switch:""},model:{value:e.blocked,callback:function(t){e.blocked=t},expression:"blocked"}},[e._v(" 禁用账号 "),n("b",[e._v("(Blocked: "+e._s(e.blocked)+")")])])],1)],1),n("b-row",{staticClass:"my-1"},[n("b-col",{attrs:{sm:"6"}},[n("label",{attrs:{for:"balance"}},[e._v("balance "),n("code",[e._v(e._s(e.userdata.balance))]),e._v(":")])]),n("b-col",{attrs:{sm:"6"}},[n("b-input-group",[n("b-form-input",{attrs:{id:"m_balance"}}),n("b-input-group-append",[n("b-button",{attrs:{variant:"info"},on:{click:e.modifyBalance}},[e._v("Add")])],1)],1)],1)],1),e._l(e.paytm_ids,(function(t,r){return n("b-row",{key:r,staticClass:"my-1"},[n("b-col",{attrs:{sm:"6"}},[n("label",{attrs:{for:"paytm_id"+r}},[e._v("paytm_id "),n("code",[e._v(e._s(t))]),e._v(":")])]),n("b-col",{attrs:{sm:"6"}},[n("b-input-group",[n("b-form-input",{attrs:{id:"paytm_id"+r}}),n("b-input-group-append",[n("b-button-group",[n("b-button",{attrs:{"data-idx":r,variant:"info"},on:{click:e.chgPaytm}},[e._v("改")]),n("b-button",{attrs:{"data-idx":r,variant:"danger"},on:{click:e.delPaytm}},[e._v("删")])],1)],1)],1)],1)],1)}))],2)],1)],1)},P=[],B=(n("9129"),j.stdret),M={name:"userMan",computed:{blocked:{get:function(){return new Date(this.userdata.block)>new Date},set:function(e){var t=this,n=e?new Date("2100/01/01"):new Date("1970/01/01");Object(O["c"])((function(e){e.emit("disableuser",t.phone,n,B((function(e){if(e)return alert(e);t.$set(t.userdata,"block",n)})))}))}},paytm_ids:function(){return Array.isArray(this.userdata.paytm_id)?this.userdata.paytm_id:[this.userdata.paytm_id]}},data:function(){return{phone:null,userdata:{}}},methods:{manipulatedata:function(e){var t=this;for(var n in e)t.$set(t.userdata,n,e[n])},findUser:function(e){if(e.preventDefault(),this.phone){var t=this.phone,n=this;Object(O["c"])((function(e){e.emit("queryuser",t,B((function(e,t){if(e)return alert(e);n.manipulatedata(t)})))}))}},modifyBalance:function(){var e=Number(document.getElementById("m_balance").value);if(!Number.isNaN(e)){var t=this.phone,n=this;Object(O["c"])((function(r){r.emit("modifybalance",t,e,B((function(e,t){if(e)return alert(e);n.manipulatedata(t)})))}))}},chgPaytm:function(e){var t=e.target.dataset.idx,n=document.getElementById("paytm_id".concat(t)).value;Array.isArray(this.userdata.paytm_id)||(t=null);var r=this;Object(O["c"])((function(e){e.emit("changepaytm",r.phone,t,n,B((function(e,t){if(e)return alert(e);r.manipulatedata(t)})))}))},delPaytm:function(e){var t=e.target.dataset.idx,n=document.getElementById("paytm_id".concat(t)).value,r=this;Object(O["c"])((function(e){e.emit("delpaytm",r.phone,n,B((function(e){if(e)return alert(e);r.$set(r.userdata,"paytm_id",null)})))}))}},mounted:function(){this.userdata={}}},U=M,N=Object(b["a"])(U,E,P,!1,null,null,null),A=N.exports,D=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-form",{staticClass:"mt-5"},[n("b-form-group",{attrs:{id:"login-phone"}},[n("b-form-input",{attrs:{type:"tel",required:"",placeholder:"Phone number"},model:{value:e.mobile,callback:function(t){e.mobile=t},expression:"mobile"}})],1),n("b-form-group",[n("b-form-input",{attrs:{type:"password",required:"",placeholder:"Password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),e.regmode?n("b-form-group",[n("b-button",{directives:[{name:"show",rawName:"v-show",value:e.regmode,expression:"regmode"}],attrs:{type:"submit",variant:"primary",block:""},on:{click:e.reg}},[e._v("Sign up")]),n("p",[e._v("首次使用，请注册管理员账号，一旦注册不可更改")])],1):n("b-button",{attrs:{type:"submit",variant:"primary",block:""},on:{click:e.dologin}},[e._v("Sign in")])],1)},F=[],T=(n("ac1f"),n("5319"),n("6821")),q=n.n(T),J={name:"login",data:function(){return{mobile:null,password:null,logged:!1,longop:!1,regmode:!1}},methods:{loggedIn:function(){return!!this.logged},reg:function(e){e.preventDefault(),this.longop=!0;var t=this.mobile,n=this.password,r=this;Object(O["c"])((function(e){function o(){r.longop=!1,e.off("reconnect_failed",o),alert("Can not reach the server")}e.on("reconnect_failed",o),e.emit("regadmin",{phone:t,pwd:n},(function(t){r.handlelogin(t),e.off("reconnect_failed",o)}))}))},dologin:function(e){e.preventDefault(),this.longop=!0;var t=this.mobile,n=this.password,r=this;Object(O["c"])((function(e){function o(){r.longop=!1,e.off("reconnect_failed",o),alert("Can not reach the server")}e.on("reconnect_failed",o),e.emit("salt",t,(function(a,i){if(a)return r.longop=!1,void alert(a);e.emit("login",{phone:t,pwd:q()(""+i+n)},(function(t,n){r.handlelogin(t,n),e.off("reconnect_failed",o)}))}))}))},handlelogin:function(e){if(this.longop=!1,e)return alert(e);localStorage.admin_logged=!0,this.$router.replace("/serverlet")}},mounted:function(){var e=this;Object(O["c"])((function(t){t.emit("adminexists",(function(t,n){if(t)return alert(t);e.regmode=!n}))}))}},G=J,L=Object(b["a"])(G,D,F,!1,null,null,null),z=L.exports;function H(e,t,n){j.loggedIn()?n():n({path:"/login",query:{redirect:e.fullPath}})}var K=new o["a"]({routes:[{path:"/",component:S,beforeEnter:H},{path:"/serverlet",component:S,beforeEnter:H},{path:"/userMoney",component:A,beforeEnter:H},{path:"/login",component:z},{path:"/logout",beforeEnter:function(e,t,n){j.logout(),n("/")}}]});r["default"].use(o["a"]),r["default"].use(i["a"]),r["default"].component("BIcon",s["a"]),r["default"].component("BIconChevronRight",c["i"]),r["default"].component("BIconChevronLeft",c["h"]),r["default"].component("BIconBoxArrowInLeft",c["b"]),r["default"].use(a["a"]),r["default"].config.productionTip=!1;var Q=new a["a"].Store({state:{me:{balance:null,id:null,paytm_id:null},countdown:null,period:null,history:[],orders:[],status:null},mutations:{}});window.v=new r["default"]({router:K,el:"#app",store:Q,$eventBus:new r["default"],render:function(e){return e(w)}})}});
//# sourceMappingURL=admin.c71402d1.js.map